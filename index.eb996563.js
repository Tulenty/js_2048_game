const t=new class{constructor(t=null){this.board=t||this.generateEmptyBoard(),this.size=4,this.score=0,this.status="idle"}generateEmptyBoard(){return Array.from({length:4},()=>[,,,,].fill(0))}addRandomTile(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.board[e][s]&&t.push([e,s]);if(t.length>0){let[e,s]=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.9>Math.random()?2:4}}moveLeft(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=this.board[e].filter(t=>0!==t);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s.splice(t+1,1),s.push(0));for(;s.length<4;)s.push(0);for(let r=0;r<4;r++)if(this.board[e][r]!==s[r]){t=!0;break}this.board[e]=s}t&&this.addRandomTile(),this.checkGameOver()}moveRight(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=this.board[e].filter(t=>0!==t);for(let t=s.length-1;t>0;t--)s[t]===s[t-1]&&(s[t]*=2,this.score+=s[t],s.splice(t-1,1),s.unshift(0));for(;s.length<4;)s.unshift(0);for(let r=0;r<4;r++)if(this.board[e][r]!==s[r]){t=!0;break}this.board[e]=s}t&&this.addRandomTile(),this.checkGameOver()}moveUp(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=0;t<4;t++)0!==this.board[t][e]&&s.push(this.board[t][e]);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s.splice(t+1,1));for(;s.length<4;)s.push(0);for(let r=0;r<4;r++)this.board[r][e]!==s[r]&&(t=!0),this.board[r][e]=s[r]}t&&this.addRandomTile(),this.checkGameOver()}moveDown(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=0;t<4;t++)0!==this.board[t][e]&&s.push(this.board[t][e]);for(let t=s.length-1;t>0;t--)s[t]===s[t-1]&&(s[t]*=2,this.score+=s[t],s.splice(t-1,1),s.unshift(0));for(;s.length<4;)s.unshift(0);for(let r=0;r<4;r++)this.board[r][e]!==s[r]&&(t=!0),this.board[r][e]=s[r]}t&&this.addRandomTile(),this.checkGameOver()}getScore(){return this.score}getState(){return this.board}checkGameOver(){this.isWin()?this.status="win":this.isLose()&&(this.status="lose")}isWin(){for(let t of this.board)if(t.includes(2048))return!0;return!1}isLose(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.board[t][e]||e<3&&this.board[t][e]===this.board[t][e+1]||t<3&&this.board[t][e]===this.board[t+1][e])return!1;return!0}getStatus(){return this.status}start(){("idle"===this.status||"lose"===this.status||"win"===this.status)&&(this.status="playing",this.addRandomTile(),this.addRandomTile())}restart(){this.score=0,this.status="idle",this.board=this.generateEmptyBoard(),this.start()}},e=document.querySelector(".start"),s=document.querySelector(".game-score"),r=document.querySelector(".message-container");function i(){let e=document.querySelectorAll(".field-cell"),i=t.getState();for(let s=0;s<i.length;s++)for(let r=0;r<i[s].length;r++){let o=e[s*t.size+r];o.textContent=i[s][r]||"",o.className=`field-cell field-cell--${i[s][r]||"empty"}`}s.textContent=t.getScore(),t.isWin()?r.querySelector(".message-win").classList.remove("hidden"):t.isLose()&&r.querySelector(".message-lose").classList.remove("hidden")}e.addEventListener("click",()=>{"playing"===t.getStatus()||"win"===t.getStatus()||"lose"===t.getStatus()?(t.restart(),r.querySelector(".message-win").classList.add("hidden"),r.querySelector(".message-lose").classList.add("hidden")):"idle"===t.getStatus()&&(t.start(),r.querySelector(".message-start").classList.add("hidden"),e.textContent="restart"),i()}),document.addEventListener("keydown",e=>{"ArrowLeft"===e.key&&t.moveLeft(),"ArrowRight"===e.key&&t.moveRight(),"ArrowUp"===e.key&&t.moveUp(),"ArrowDown"===e.key&&t.moveDown(),i()});
//# sourceMappingURL=index.eb996563.js.map
